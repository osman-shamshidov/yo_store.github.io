#!/usr/bin/env python3
"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—É—Å—Ç—ã—Ö description –∏ details –≤ level2_descriptions
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—É—é –ª–æ–≥–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –∏ –ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
"""

import os
import sys
import json
from datetime import datetime

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –≤ –ø—É—Ç—å –¥–ª—è –∏–º–ø–æ—Ä—Ç–æ–≤
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from database import SessionLocal
from models import Level2Description
import time

def search_product_info(product_name: str) -> tuple[str, dict]:
    """
    –ü–æ–∏—Å–∫ –æ–ø–∏—Å–∞–Ω–∏—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç (–æ–ø–∏—Å–∞–Ω–∏–µ, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏)
    """
    name_lower = product_name.lower()
    
    # Apple Watch
    if 'apple watch' in name_lower:
        if 'ultra' in name_lower:
            if 'milanese' in name_lower:
                description = f"{product_name} ‚Äî –ø—Ä–µ–º–∏–∞–ª—å–Ω—ã–µ —É–º–Ω—ã–µ —á–∞—Å—ã Apple —Å —Ä–µ–º–µ—à–∫–æ–º Milanese Loop –∏–∑ –Ω–µ—Ä–∂–∞–≤–µ—é—â–µ–π —Å—Ç–∞–ª–∏. –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–ø–æ—Ä—Ç–∞ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED",
                    "–†–µ–º–µ—à–æ–∫": "Milanese Loop (–Ω–µ—Ä–∂–∞–≤–µ—é—â–∞—è —Å—Ç–∞–ª—å)",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Ç–µ–ª–∞",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, GPS",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 36 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR100 (–¥–æ 100 –º–µ—Ç—Ä–æ–≤)"
                }
            elif 'trail' in name_lower:
                description = f"{product_name} ‚Äî —É–º–Ω—ã–µ —á–∞—Å—ã Apple –¥–ª—è —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –≤–∏–¥–æ–≤ —Å–ø–æ—Ä—Ç–∞ —Å —Ä–µ–º–µ—à–∫–æ–º Trail Loop. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED, 49–º–º",
                    "–†–µ–º–µ—à–æ–∫": "Trail Loop (–Ω–µ–π–ª–æ–Ω)",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Ç–µ–ª–∞",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –¥–≤–æ–π–Ω–æ–π GPS",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 36 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR100 (–¥–æ 100 –º–µ—Ç—Ä–æ–≤)",
                    "–ú–∞—Ç–µ—Ä–∏–∞–ª": "–¢–∏—Ç–∞–Ω"
                }
            else:
                description = f"{product_name} ‚Äî —Ñ–ª–∞–≥–º–∞–Ω—Å–∫–∏–µ —É–º–Ω—ã–µ —á–∞—Å—ã Apple –¥–ª—è —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –≤–∏–¥–æ–≤ —Å–ø–æ—Ä—Ç–∞ –∏ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED, 49–º–º",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Ç–µ–ª–∞",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –¥–≤–æ–π–Ω–æ–π GPS",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 36 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR100 (–¥–æ 100 –º–µ—Ç—Ä–æ–≤)",
                    "–ú–∞—Ç–µ—Ä–∏–∞–ª": "–¢–∏—Ç–∞–Ω"
                }
        elif 's11' in name_lower:
            if 'titanium' in name_lower:
                description = f"{product_name} ‚Äî —É–º–Ω—ã–µ —á–∞—Å—ã Apple —Å —Ç–∏—Ç–∞–Ω–æ–≤—ã–º –∫–æ—Ä–ø—É—Å–æ–º. –ü—Ä–µ–º–∏–∞–ª—å–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –ø–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED",
                    "–ú–∞—Ç–µ—Ä–∏–∞–ª": "–¢–∏—Ç–∞–Ω",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 18 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR50 (–¥–æ 50 –º–µ—Ç—Ä–æ–≤)"
                }
            elif 'sport band' in name_lower:
                description = f"{product_name} ‚Äî —É–º–Ω—ã–µ —á–∞—Å—ã Apple —Å —Ä–µ–º–µ—à–∫–æ–º Sport Band. –ò–¥–µ–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED",
                    "–†–µ–º–µ—à–æ–∫": "Sport Band (—Å–∏–ª–∏–∫–æ–Ω)",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 18 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR50 (–¥–æ 50 –º–µ—Ç—Ä–æ–≤)"
                }
            else:
                description = f"{product_name} ‚Äî —É–º–Ω—ã–µ —á–∞—Å—ã Apple –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ñ–∏—Ç–Ω–µ—Å–∞."
                details = {
                    "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                    "–î–∏—Å–ø–ª–µ–π": "Always-On Retina LTPO OLED",
                    "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≠–ö–ì, –∫–∏—Å–ª–æ—Ä–æ–¥–∞ –≤ –∫—Ä–æ–≤–∏",
                    "–§–∏—Ç–Ω–µ—Å": "–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
                    "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 18 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                    "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "WR50 (–¥–æ 50 –º–µ—Ç—Ä–æ–≤)"
                }
        else:
            description = f"{product_name} ‚Äî —É–º–Ω—ã–µ —á–∞—Å—ã Apple —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ñ–∏—Ç–Ω–µ—Å–∞."
            details = {
                "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "watchOS",
                "–î–∏—Å–ø–ª–µ–π": "Always-On Retina",
                "–ó–¥–æ—Ä–æ–≤—å–µ": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ñ–∏—Ç–Ω–µ—Å–∞",
                "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 18 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã"
            }
    
    # JBL –∫–æ–ª–æ–Ω–∫–∏
    elif 'jbl' in name_lower:
        if 'boombox' in name_lower:
            description = f"{product_name} ‚Äî –º–æ—â–Ω–∞—è –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ JBL —Å –≥–ª—É–±–æ–∫–∏–º –±–∞—Å–æ–º –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å—é. –ò–¥–µ–∞–ª—å–Ω–∞ –¥–ª—è –≤–µ—á–µ—Ä–∏–Ω–æ–∫ –∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–æ–∑–¥—É—Ö–µ."
            details = {
                "–¢–∏–ø": "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞",
                "–ú–æ—â–Ω–æ—Å—Ç—å": "–í—ã—Å–æ–∫–∞—è –º–æ—â–Ω–æ—Å—Ç—å –∑–≤—É–∫–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–ª–∏—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth, USB-C",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IPX7 (–≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–∞—è)",
                "–ó–≤—É–∫": "–ú–æ—â–Ω—ã–π –±–∞—Å, —Å—Ç–µ—Ä–µ–æ–∑–≤—É–∫"
            }
        elif 'xtreme' in name_lower:
            description = f"{product_name} ‚Äî –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞ JBL —Å –º–æ—â–Ω—ã–º –∑–≤—É–∫–æ–º –∏ –≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–º –∫–æ—Ä–ø—É—Å–æ–º."
            details = {
                "–¢–∏–ø": "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞",
                "–ú–æ—â–Ω–æ—Å—Ç—å": "–í—ã—Å–æ–∫–∞—è –º–æ—â–Ω–æ—Å—Ç—å –∑–≤—É–∫–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–æ 15 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth, USB-C",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IPX7 (–≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–∞—è)",
                "–ó–≤—É–∫": "–°—Ç–µ—Ä–µ–æ–∑–≤—É–∫ —Å –±–∞—Å–æ–º"
            }
        elif 'flip' in name_lower:
            description = f"{product_name} ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞ JBL —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–≤—É–∫–æ–º."
            details = {
                "–¢–∏–ø": "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞",
                "–†–∞–∑–º–µ—Ä": "–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–æ 12 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth, USB-C",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IPX7 (–≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–∞—è)",
                "–ó–≤—É–∫": "–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π —Å—Ç–µ—Ä–µ–æ–∑–≤—É–∫"
            }
        else:
            description = f"{product_name} ‚Äî –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞ JBL —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –∑–≤—É–∫–æ–º."
            details = {
                "–¢–∏–ø": "–ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è Bluetooth-–∫–æ–ª–æ–Ω–∫–∞",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth",
                "–ó–≤—É–∫": "–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–≤—É–∫"
            }
    
    # Samsung Galaxy
    elif 'samsung' in name_lower and 'galaxy' in name_lower:
        if 's24 ultra' in name_lower or 's25 ultra' in name_lower:
            description = f"{product_name} ‚Äî —Ñ–ª–∞–≥–º–∞–Ω—Å–∫–∏–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω Samsung —Å S Pen, –ø–µ—Ä–µ–¥–æ–≤—ã–º–∏ –∫–∞–º–µ—Ä–∞–º–∏ –∏ –º–æ—â–Ω—ã–º –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º."
            details = {
                "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "Android",
                "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä": "Snapdragon 8 Gen 3 –∏–ª–∏ –Ω–æ–≤–µ–µ",
                "–î–∏—Å–ø–ª–µ–π": "Dynamic AMOLED 2X, 6.8 –¥—é–π–º–∞, 120 –ì—Ü",
                "–ö–∞–º–µ—Ä–∞": "200 –ú–ü –æ—Å–Ω–æ–≤–Ω–∞—è –∫–∞–º–µ—Ä–∞, 50 –ú–ü —Ç–µ–ª–µ–æ–±—ä–µ–∫—Ç–∏–≤, 12 –ú–ü —Å–≤–µ—Ä—Ö—à–∏—Ä–æ–∫–æ—É–≥–æ–ª—å–Ω–∞—è",
                "S Pen": "–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π S Pen",
                "–ü–∞–º—è—Ç—å": "12/16 –ì–ë RAM, –¥–æ 1 –¢–ë —Ö—Ä–∞–Ω–∏–ª–∏—â–∞",
                "–ó–∞—Ä—è–¥–∫–∞": "–ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞ 45W, –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "5000 –º–ê—á"
            }
        else:
            description = f"{product_name} ‚Äî —Å–º–∞—Ä—Ç—Ñ–æ–Ω Samsung —Å –ø–µ—Ä–µ–¥–æ–≤—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –æ—Ç–ª–∏—á–Ω—ã–º–∏ –∫–∞–º–µ—Ä–∞–º–∏."
            details = {
                "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "Android",
                "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä": "Snapdragon –∏–ª–∏ Exynos",
                "–î–∏—Å–ø–ª–µ–π": "Dynamic AMOLED",
                "–ö–∞–º–µ—Ä–∞": "–ú–Ω–æ–≥–æ–º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞–º–µ—Ä",
                "–ó–∞—Ä—è–¥–∫–∞": "–ë—ã—Å—Ç—Ä–∞—è –∑–∞—Ä—è–¥–∫–∞, –±–µ—Å–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∑–∞—Ä—è–¥–∫–∞"
            }
    
    # Whoop
    elif 'whoop' in name_lower:
        if 'peak' in name_lower:
            description = f"{product_name} ‚Äî —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä Whoop –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–ø–æ—Ä—Ç—Å–º–µ–Ω–æ–≤. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Å–Ω–∞."
            details = {
                "–¢–∏–ø": "–§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä",
                "–§—É–Ω–∫—Ü–∏–∏": "–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ß–°–°, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è, –Ω–∞–≥—Ä—É–∑–∫–∏, —Å–Ω–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–æ 5 –¥–Ω–µ–π —Ä–∞–±–æ—Ç—ã",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IP68",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth",
                "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ": "Whoop App —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π"
            }
        elif 'life' in name_lower:
            description = f"{product_name} ‚Äî —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä Whoop –¥–ª—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–¥–æ—Ä–æ–≤—å—è –∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏."
            details = {
                "–¢–∏–ø": "–§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä",
                "–§—É–Ω–∫—Ü–∏–∏": "–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ß–°–°, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å–Ω–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–æ 5 –¥–Ω–µ–π —Ä–∞–±–æ—Ç—ã",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IP68",
                "–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ": "Bluetooth",
                "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ": "Whoop App"
            }
        else:
            description = f"{product_name} ‚Äî —Ñ–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä Whoop —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∑–¥–æ—Ä–æ–≤—å—è –∏ —Ñ–∏—Ç–Ω–µ—Å–∞."
            details = {
                "–¢–∏–ø": "–§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä",
                "–§—É–Ω–∫—Ü–∏–∏": "–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ß–°–°, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, —Å–Ω–∞",
                "–ë–∞—Ç–∞—Ä–µ—è": "–î–ª–∏—Ç–µ–ª—å–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç—å",
                "–í–æ–¥–æ–∑–∞—â–∏—Ç–∞": "IP68"
            }
    
    # iPad
    elif 'ipad' in name_lower:
        if 'air' in name_lower and 'm3' in name_lower:
            description = f"{product_name} ‚Äî –ø–ª–∞–Ω—à–µ—Ç Apple —Å —á–∏–ø–æ–º M3, –±–æ–ª—å—à–∏–º —ç–∫—Ä–∞–Ω–æ–º 13 –¥—é–π–º–æ–≤ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Pencil."
            details = {
                "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "iPadOS",
                "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä": "Apple M3",
                "–î–∏—Å–ø–ª–µ–π": "Liquid Retina, 13 –¥—é–π–º–æ–≤",
                "–ü–æ–¥–¥–µ—Ä–∂–∫–∞": "Apple Pencil, Magic Keyboard",
                "–ü–∞–º—è—Ç—å": "128 –ì–ë - 1 –¢–ë",
                "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 10 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã",
                "–ö–∞–º–µ—Ä–∞": "12 –ú–ü –æ—Å–Ω–æ–≤–Ω–∞—è, 12 –ú–ü —Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω–∞—è"
            }
        else:
            description = f"{product_name} ‚Äî –ø–ª–∞–Ω—à–µ—Ç Apple –¥–ª—è —Ä–∞–±–æ—Ç—ã –∏ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Apple Pencil."
            details = {
                "–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞": "iPadOS",
                "–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä": "Apple A-series –∏–ª–∏ M-series",
                "–î–∏—Å–ø–ª–µ–π": "Liquid Retina",
                "–ü–æ–¥–¥–µ—Ä–∂–∫–∞": "Apple Pencil, Magic Keyboard",
                "–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä": "–î–æ 10 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã"
            }
    
    # Dyson
    elif 'dyson' in name_lower:
        if 'airwrap' in name_lower:
            description = f"{product_name} ‚Äî –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞–π–ª–µ—Ä Dyson –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø—Ä–∏—á–µ—Å–æ–∫. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è Coanda –¥–ª—è –±–µ—Ä–µ–∂–Ω–æ–π —É–∫–ª–∞–¥–∫–∏ –≤–æ–ª–æ—Å."
            details = {
                "–¢–∏–ø": "–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞–π–ª–µ—Ä",
                "–§—É–Ω–∫—Ü–∏–∏": "–°—É—à–∫–∞, –∑–∞–≤–∏–≤–∫–∞, –≤—ã–ø—Ä—è–º–ª–µ–Ω–∏–µ –≤–æ–ª–æ—Å",
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è": "Coanda —ç—Ñ—Ñ–µ–∫—Ç, –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–æ–π",
                "–ù–∞—Å–∞–¥–∫–∏": "–ù–µ—Å–∫–æ–ª—å–∫–æ –Ω–∞—Å–∞–¥–æ–∫ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏—á–µ—Å–æ–∫",
                "–ú–æ—â–Ω–æ—Å—Ç—å": "–í—ã—Å–æ–∫–∞—è –º–æ—â–Ω–æ—Å—Ç—å",
                "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å": "–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–≥—Ä–µ–≤–∞"
            }
        elif 'nural' in name_lower or '—Ñ–µ–Ω' in name_lower:
            description = f"{product_name} ‚Äî —Ñ–µ–Ω Dyson —Å –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π –∑–∞—â–∏—Ç—ã –≤–æ–ª–æ—Å –æ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π."
            details = {
                "–¢–∏–ø": "–§–µ–Ω",
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è": "–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã",
                "–ú–æ—â–Ω–æ—Å—Ç—å": "–í—ã—Å–æ–∫–∞—è –º–æ—â–Ω–æ—Å—Ç—å —Å—É—à–∫–∏",
                "–ó–∞—â–∏—Ç–∞": "–ó–∞—â–∏—Ç–∞ –≤–æ–ª–æ—Å –æ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π",
                "–ù–∞—Å–∞–¥–∫–∏": "–†–∞–∑–ª–∏—á–Ω—ã–µ –Ω–∞—Å–∞–¥–∫–∏ –¥–ª—è —É–∫–ª–∞–¥–∫–∏",
                "–î–∏–∑–∞–π–Ω": "–≠—Ä–≥–æ–Ω–æ–º–∏—á–Ω—ã–π –¥–∏–∑–∞–π–Ω"
            }
        else:
            description = f"{product_name} ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —É—Ö–æ–¥–∞ –∑–∞ –≤–æ–ª–æ—Å–∞–º–∏ Dyson —Å –ø–µ—Ä–µ–¥–æ–≤—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏."
            details = {
                "–¢–∏–ø": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥–ª—è —É—Ö–æ–¥–∞ –∑–∞ –≤–æ–ª–æ—Å–∞–º–∏",
                "–ë—Ä–µ–Ω–¥": "Dyson",
                "–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è": "–ü–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —É—Ö–æ–¥–∞ –∑–∞ –≤–æ–ª–æ—Å–∞–º–∏"
            }
    
    # –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤
    else:
        description = f"{product_name} ‚Äî –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º–∏ –∏ –æ—Ç–ª–∏—á–Ω—ã–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏."
        details = {
            "–ö–∞—Ç–µ–≥–æ—Ä–∏—è": "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
            "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏": "–ü–µ—Ä–µ–¥–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏"
        }
    
    return description, details

def fill_empty_descriptions():
    """–ó–∞–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –ø—É—Å—Ç—ã–µ description –∏ details –≤ level2_descriptions"""
    
    db = SessionLocal()
    
    try:
        # –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ –∑–∞–ø–∏—Å–∏ —Å –ø—É—Å—Ç—ã–º–∏ description –∏–ª–∏ details
        empty_records = db.query(Level2Description).filter(
            (Level2Description.description == "") | 
            (Level2Description.description.is_(None)) |
            (Level2Description.details == "{}") |
            (Level2Description.details.is_(None))
        ).all()
        
        print(f"üìä –ù–∞–π–¥–µ–Ω–æ {len(empty_records)} –∑–∞–ø–∏—Å–µ–π —Å –ø—É—Å—Ç—ã–º–∏ description –∏–ª–∏ details")
        
        if not empty_records:
            print("‚úÖ –í—Å–µ –∑–∞–ø–∏—Å–∏ —É–∂–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!")
            return
        
        print("\nüìù –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π...")
        updated_count = 0
        
        for i, record in enumerate(empty_records, 1):
            print(f"\n[{i}/{len(empty_records)}] –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º: {record.level_2}")
            
            try:
                # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–¥—É–∫—Ç–µ
                description, details = search_product_info(record.level_2)
                
                # –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –ø—É—Å—Ç—ã–µ –ø–æ–ª—è
                if not record.description or record.description == "":
                    record.description = description
                
                if not record.details or record.details == "{}":
                    record.details = json.dumps(details, ensure_ascii=False)
                
                record.updated_at = datetime.utcnow()
                
                updated_count += 1
                
                print(f"   ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è {record.level_2}")
                print(f"      –û–ø–∏—Å–∞–Ω–∏–µ: {description[:80]}...")
                print(f"      –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏: {len(details)} –ø–æ–ª–µ–π")
                
                # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
                time.sleep(0.5)
                
            except Exception as e:
                print(f"   ‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ {record.level_2}: {e}")
                continue
        
        # –ö–æ–º–º–∏—Ç–∏–º –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
        if updated_count > 0:
            db.commit()
            print(f"\n‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ {updated_count} –∑–∞–ø–∏—Å–µ–π!")
        else:
            print("\n‚ö†Ô∏è –ù–µ –±—ã–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        db.rollback()
        raise
    finally:
        db.close()

if __name__ == "__main__":
    fill_empty_descriptions()
