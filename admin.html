<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yo Store - –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);
            min-height: 100vh;
            color: #111827;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #111827;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            font-weight: 700;
        }
        
        .logo {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            object-fit: cover;
        }
        
        .admin-nav {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 24px;
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .admin-nav button {
            padding: 10px 20px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            color: #374151;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }
        
        .admin-nav button:hover {
            background: #f9fafb;
            border-color: #d1d5db;
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .admin-nav button.active {
            background: #007AFF;
            color: white;
            border-color: #007AFF;
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
        }
        
        .admin-content {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 24px;
            color: #111827;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .admin-content h2 {
            color: #111827;
            font-weight: 700;
            font-size: 1.75rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-content.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            background: white;
            color: #111827;
        }
        
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #007AFF;
            color: white;
            border: none;
        }
        
        .btn-primary:hover {
            background: #0051D5;
            box-shadow: 0 2px 8px rgba(0, 122, 255, 0.3);
        }
        
        .btn-success {
            background: #10b981;
            color: white;
            border: none;
        }
        
        .btn-success:hover {
            background: #059669;
            box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);
        }
        
        .btn-danger {
            background: #ef4444;
            color: white;
            border: none;
        }
        
        .btn-danger:hover {
            background: #dc2626;
            box-shadow: 0 2px 8px rgba(239, 68, 68, 0.3);
        }
        
        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #e5e7eb;
        }
        
        .btn-secondary:hover {
            background: #e5e7eb;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .product-card {
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 20px;
            background: white;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .product-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }
        
        .product-card h3 {
            margin-bottom: 12px;
            color: #111827;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .product-card p {
            margin-bottom: 8px;
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .status-success {
            color: #10b981;
            font-weight: 600;
        }
        
        .status-warning {
            color: #f59e0b;
            font-weight: 600;
        }
        
        .status-error {
            color: #ef4444;
            font-weight: 600;
        }
        
        .draggable-image {
            user-select: none;
        }
        
        .draggable-image.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }
        
        .draggable-image.drag-over {
            border: 2px dashed #007AFF !important;
            background: rgba(0, 122, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .admin-nav {
                flex-direction: column;
            }
            
            .product-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="color: #007AFF;">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="9" y1="3" x2="9" y2="21"></line>
                    <line x1="15" y1="3" x2="15" y2="21"></line>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                    <line x1="3" y1="15" x2="21" y2="15"></line>
                </svg>
                Yo Store Admin
                <img src="/static/images/logo.jpg" alt="Yo Store" class="logo">
            </h1>
            <p style="color: #6b7280; font-size: 1.1rem; margin-top: 5px;">–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –º–∞–≥–∞–∑–∏–Ω–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏</p>
        </div>
        
        <div class="admin-nav">
            <button onclick="showSection('orders')" class="active">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                    <path d="M9 14l2 2 4-4"></path>
                </svg>
                –ó–∞–∫–∞–∑—ã
            </button>
            <button onclick="showSection('products')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
                    <path d="M3 6h18"></path>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
                –¢–æ–≤–∞—Ä—ã
            </button>
            <button onclick="showSection('categories')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 7h16"></path>
                    <path d="M4 12h16"></path>
                    <path d="M4 17h16"></path>
                </svg>
                –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            </button>
            <button onclick="showSection('prices')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
                –¶–µ–Ω—ã
            </button>
            <button onclick="showSection('images')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            </button>
            <button onclick="showSection('upload')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                –ó–∞–≥—Ä—É–∑–∫–∞ Excel
            </button>
            <button onclick="showSection('export')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                –≠–∫—Å–ø–æ—Ä—Ç
            </button>
            <button onclick="showSection('manual')">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 16v-4"></path>
                    <path d="M12 8h.01"></path>
                </svg>
                –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            </button>
        </div>
        
        <!-- Orders Section -->
        <div id="orders" class="admin-content active">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path>
                    <rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect>
                    <path d="M9 14l2 2 4-4"></path>
                </svg>
                –ó–∞–∫–∞–∑—ã
            </h2>
            <div class="form-group" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                <button onclick="loadOrders()" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 6px; font-weight: 500;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="23 4 23 10 17 10"></polyline>
                        <polyline points="1 20 1 14 7 14"></polyline>
                        <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                    </svg>
                    –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                </button>
            </div>
            <div id="orders-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>
            </div>
        </div>
        
        <!-- Products Section -->
        <div id="products" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"></path>
                    <path d="M3 6h18"></path>
                    <path d="M16 10a4 4 0 0 1-8 0"></path>
                </svg>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏
            </h2>
            <div class="form-group" style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button onclick="showAddProductForm()" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                <button onclick="downloadCurrentProducts()" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã</button>
                <button onclick="showUploadProductsForm()" class="btn btn-warning">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
            </div>
            <div id="products-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>
            </div>
        </div>
        
        <!-- Categories Section -->
        <div id="categories" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 7h16"></path>
                    <path d="M4 12h16"></path>
                    <path d="M4 17h16"></path>
                </svg>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏
            </h2>
            <div class="form-group">
                <button onclick="showAddCategoryForm()" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
            </div>
            <div id="categories-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</p>
            </div>
        </div>
        
        <!-- Prices Section -->
        <div id="prices" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–∞–º–∏
            </h2>
            
            <div class="form-group">
                <h3>üìä –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Excel</h3>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <p><strong>–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:</strong> SKU - –ù–æ–≤–∞—è —Ü–µ–Ω–∞ - –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞</p>
                    <p><strong>–ü—Ä–∏–º–µ—Ä:</strong></p>
                    <pre style="background: white; padding: 10px; border-radius: 5px;">
SKU              | –ù–æ–≤–∞—è —Ü–µ–Ω–∞ | –°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞
APPIP16          | 59990      | 69990
APPIP16PRO       | 89990      | 99990
IPHONE17PROMAX   | 129990     | 149990
                    </pre>
                </div>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <a href="/download-price-template" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω Excel</a>
                    <span style="color: #666;">–∏–ª–∏</span>
                </div>
            </div>
            
            <div class="form-group">
                <label for="price-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏:</label>
                <input type="file" id="price-excel-file" accept=".xlsx,.xls">
            </div>
            <button onclick="uploadPriceExcel()" class="btn btn-success">üì§ –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã –∏–∑ Excel</button>
            <div id="price-excel-result"></div>
            
            <hr style="margin: 30px 0;">
            
            <div class="form-group">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h3 style="margin: 0; display: flex; align-items: center; gap: 8px;">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω
                    </h3>
                    <button onclick="loadPricesTable()" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 6px; font-weight: 500;">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <polyline points="1 20 1 14 7 14"></polyline>
                            <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                        </svg>
                        –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫
                    </button>
            </div>
                <div id="prices-table-container">
                    <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω...</p>
            </div>
                <div id="price-result" style="margin-top: 20px;"></div>
            </div>
        </div>
        
        <!-- Upload Section -->
        <div id="upload" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel
            </h2>
            
            <div class="form-group">
                <h3>üìã –®–∞–±–ª–æ–Ω—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</h3>
                <p>–°–∫–∞—á–∞–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã Excel –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω:</p>
                <div style="display: flex; gap: 15px; margin: 15px 0;">
                    <a href="/api/excel/template/products" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ç–æ–≤–∞—Ä–æ–≤</a>
                    <a href="/download-price-template" class="btn btn-success">üì• –®–∞–±–ª–æ–Ω —Ü–µ–Ω</a>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</h4>
                    <ol style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>–°–∫–∞—á–∞–π—Ç–µ —à–∞–±–ª–æ–Ω</strong> - –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ç–∏–ø (—Ç–æ–≤–∞—Ä—ã –∏–ª–∏ —Ü–µ–Ω—ã)</li>
                        <li><strong>–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ</strong> - —Å–ª–µ–¥—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç—É –≤ —à–∞–±–ª–æ–Ω–µ</li>
                        <li><strong>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª</strong> - –≤—ã–±–µ—Ä–∏—Ç–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–∞–≥—Ä—É–∑–∏—Ç—å"</li>
                        <li><strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç</strong> - —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏</li>
                    </ol>
                </div>
            </div>
            
            <div class="form-group">
                <h3>üìä –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å —Ç–æ–≤–∞—Ä–∞–º–∏ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–∞—Ç–∞–ª–æ–≥:</p>
                <div class="form-group">
                    <label for="excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ç–æ–≤–∞—Ä–∞–º–∏:</label>
                    <input type="file" id="excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadExcel()" class="btn btn-primary">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ç–æ–≤–∞—Ä—ã</button>
                <div id="upload-result"></div>
            </div>
            
            <div class="form-group">
                <h3>üí∞ –ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å —Ü–µ–Ω–∞–º–∏ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</p>
                <div class="form-group">
                    <label for="price-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏:</label>
                    <input type="file" id="price-excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadPriceExcel()" class="btn btn-success">üì§ –û–±–Ω–æ–≤–∏—Ç—å —Ü–µ–Ω—ã</button>
                <div id="price-excel-result"></div>
            </div>
            
            <div class="form-group">
                <h3>üñºÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</h3>
                <p>–ó–∞–≥—Ä—É–∑–∏—Ç–µ Excel —Ñ–∞–π–ª —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤ (–ø–æ –º–æ–¥–µ–ª–∏ –∏ —Ü–≤–µ—Ç—É):</p>
                <div class="form-group">
                    <label for="images-excel-file">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:</label>
                    <input type="file" id="images-excel-file" accept=".xlsx,.xls">
                </div>
                <button onclick="uploadImagesExcel()" class="btn btn-info">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
                <div id="images-excel-result"></div>
            </div>
        </div>
        
        <!-- Export Section -->
        <div id="export" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
            </h2>
            
            <div class="form-group">
                <h3>üìä –ü–æ–ª–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≤—Å—é –±–∞–∑—É —Ç–æ–≤–∞—Ä–æ–≤ —Å–æ –≤—Å–µ–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏ (ID, SKU, –Ω–∞–∑–≤–∞–Ω–∏—è, –æ–ø–∏—Å–∞–Ω–∏—è, —Ü–µ–Ω—ã, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ —Ç.–¥.)</p>
                <a href="/export-products" class="btn btn-primary">üì• –°–∫–∞—á–∞—Ç—å –≤–µ—Å—å –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</a>
            </div>
            
            <div class="form-group">
                <h3>üí∞ –í—Å–µ —Ü–µ–Ω—ã</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≤—Å–µ —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–æ–≤ –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ (SKU, –Ω–∞–∑–≤–∞–Ω–∏—è, —Ç–µ–∫—É—â–∏–µ –∏ —Å—Ç–∞—Ä—ã–µ —Ü–µ–Ω—ã, —Å–∫–∏–¥–∫–∏)</p>
                <a href="/export-prices" class="btn btn-success">üì• –°–∫–∞—á–∞—Ç—å –≤—Å–µ —Ü–µ–Ω—ã</a>
            </div>
            
            <div class="form-group">
                <h3>üìã –®–∞–±–ª–æ–Ω—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è</h3>
                <p>–°–∫–∞—á–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</p>
                <div style="display: flex; gap: 10px; margin-top: 10px;">
                    <a href="/download-price-template" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ü–µ–Ω</a>
                    <a href="/api/excel/template/products" class="btn btn-primary">üì• –®–∞–±–ª–æ–Ω —Ç–æ–≤–∞—Ä–æ–≤</a>
                </div>
            </div>
            
            <div class="form-group" style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <h4>üí° –ü–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</h4>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>–ü–æ–ª–Ω—ã–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç</strong> - —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –æ —Ç–æ–≤–∞—Ä–∞—Ö –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</li>
                    <li><strong>–í—Å–µ —Ü–µ–Ω—ã</strong> - –æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π</li>
                    <li><strong>–®–∞–±–ª–æ–Ω—ã</strong> - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</li>
                </ul>
            </div>
        </div>
        
        <!-- Images Section -->
        <div id="images" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <circle cx="8.5" cy="8.5" r="1.5"></circle>
                    <polyline points="21 15 16 10 5 21"></polyline>
                </svg>
                –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
            </h2>
            <div class="form-group" style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                <button onclick="loadAllImages()" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                <button onclick="showAddImageForm()" class="btn btn-success">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</button>
            </div>
            <div id="images-content">
                <p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>
            </div>
        </div>
        
        <!-- Manual Management Section -->
        <div id="manual" class="admin-content">
            <h2>
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M12 16v-4"></path>
                    <path d="M12 8h.01"></path>
                </svg>
                –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω–∞–º–∏
            </h2>
            <div class="form-group">
                <button onclick="openManualPriceManager()" class="btn btn-primary">–û—Ç–∫—Ä—ã—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä —Ü–µ–Ω</button>
            </div>
            <div id="manual-content"></div>
        </div>
    </div>

    <script>
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.admin-content').forEach(section => {
                section.classList.remove('active');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.admin-nav button').forEach(buttons => {
                buttons.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–µ–∫—Ü–∏–∏
            if (sectionId === 'products') {
                loadProducts();
            } else if (sectionId === 'categories') {
                loadCategories();
            } else if (sectionId === 'orders') {
                loadOrders();
            } else if (sectionId === 'images') {
                loadAllImages();
            } else if (sectionId === 'prices') {
                loadPricesTable();
            }
        }
        
        function loadOrders() {
            const content = document.getElementById('orders-content');
            content.innerHTML = '<p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</p>';
            
            fetch('/api/orders')
            .then(response => response.json())
            .then(result => {
                if (result.success && result.orders) {
                    if (result.orders.length === 0) {
                        content.innerHTML = '<p style="color: #666;">–ó–∞–∫–∞–∑—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                        return;
                    }
                    
                    let html = `<div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4>üìä –í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤: ${result.orders.length}</h4>
                    </div>`;
                    
                    html += '<div style="display: flex; flex-direction: column; gap: 16px;">';
                    
                    result.orders.forEach(order => {
                        const statusColors = {
                            'new': '#007AFF',
                            'processing': '#f59e0b',
                            'completed': '#10b981',
                            'cancelled': '#ef4444'
                        };
                        const statusLabels = {
                            'new': '–ù–æ–≤—ã–π',
                            'processing': '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ',
                            'completed': '–ó–∞–≤–µ—Ä—à–µ–Ω',
                            'cancelled': '–û—Ç–º–µ–Ω–µ–Ω'
                        };
                        const statusColor = statusColors[order.status] || '#6b7280';
                        const statusLabel = statusLabels[order.status] || order.status;
                        
                        const shippingTypeLabel = order.shipping_type === 'delivery' ? '–î–æ—Å—Ç–∞–≤–∫–∞' : '–°–∞–º–æ–≤—ã–≤–æ–∑';
                        const contactMethodLabels = {
                            'phone': '–¢–µ–ª–µ—Ñ–æ–Ω',
                            'email': 'Email',
                            'telegram': 'Telegram',
                            'whatsapp': 'WhatsApp'
                        };
                        const contactMethodLabel = contactMethodLabels[order.contact_method] || order.contact_method;
                        
                        const createdDate = order.created_at ? new Date(order.created_at).toLocaleString('ru-RU') : '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
                        
                        html += `
                            <div class="product-card" style="position: relative;">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                    <div>
                                        <h3 style="margin: 0 0 8px 0; color: #111827;">–ó–∞–∫–∞–∑ #${order.order_number}</h3>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.875rem;">${createdDate}</p>
                                    </div>
                                    <span style="padding: 4px 12px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; background: ${statusColor}20; color: ${statusColor};">
                                        ${statusLabel}
                                    </span>
                                </div>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 12px;">
                                    <div>
                                        <p style="margin: 0 0 4px 0; color: #6b7280; font-size: 0.875rem;"><strong>–ö–ª–∏–µ–Ω—Ç:</strong> ${order.customer_name}</p>
                                        <p style="margin: 0 0 4px 0; color: #6b7280; font-size: 0.875rem;"><strong>${contactMethodLabel}:</strong> ${order.contact_value}</p>
                                        <p style="margin: 0; color: #6b7280; font-size: 0.875rem;"><strong>–¢–∏–ø –¥–æ—Å—Ç–∞–≤–∫–∏:</strong> ${shippingTypeLabel}</p>
                                    </div>
                                    <div>
                                        <p style="margin: 0 0 4px 0; color: #6b7280; font-size: 0.875rem;"><strong>–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤:</strong> ${order.total.toLocaleString()} ‚ÇΩ</p>
                                        ${order.discount_amount > 0 ? `<p style="margin: 0 0 4px 0; color: #10b981; font-size: 0.875rem;"><strong>–°–∫–∏–¥–∫–∞:</strong> -${order.discount_amount.toLocaleString()} ‚ÇΩ</p>` : ''}
                                        ${order.promo_code ? `<p style="margin: 0 0 4px 0; color: #6b7280; font-size: 0.875rem;"><strong>–ü—Ä–æ–º–æ–∫–æ–¥:</strong> ${order.promo_code}</p>` : ''}
                                        <p style="margin: 0; color: #111827; font-size: 1rem; font-weight: 600;"><strong>–ò—Ç–æ–≥–æ:</strong> ${order.final_total.toLocaleString()} ‚ÇΩ</p>
                                    </div>
                                </div>
                                
                                ${order.address ? `<p style="margin: 0 0 12px 0; color: #6b7280; font-size: 0.875rem;"><strong>–ê–¥—Ä–µ—Å:</strong> ${order.address}</p>` : ''}
                                ${order.comment ? `<p style="margin: 0 0 12px 0; color: #6b7280; font-size: 0.875rem;"><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> ${order.comment}</p>` : ''}
                                
                                <div style="margin-top: 12px;">
                                    <button onclick="toggleOrderItems(${order.id})" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 6px; font-weight: 500; padding: 8px 16px; font-size: 0.875rem;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="order-arrow-${order.id}">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                        –¢–æ–≤–∞—Ä—ã (${order.items.length})
                                    </button>
                                </div>
                                
                                <div id="order-items-${order.id}" style="display: none; margin-top: 16px; padding: 16px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb;">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="border-bottom: 1px solid #e5e7eb;">
                                                <th style="padding: 8px; text-align: left; font-weight: 600; color: #111827; font-size: 0.875rem;">–¢–æ–≤–∞—Ä</th>
                                                <th style="padding: 8px; text-align: right; font-weight: 600; color: #111827; font-size: 0.875rem;">–¶–µ–Ω–∞</th>
                                                <th style="padding: 8px; text-align: center; font-weight: 600; color: #111827; font-size: 0.875rem;">–ö–æ–ª-–≤–æ</th>
                                                <th style="padding: 8px; text-align: right; font-weight: 600; color: #111827; font-size: 0.875rem;">–°—É–º–º–∞</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                        `;
                        
                        order.items.forEach(item => {
                            const itemTotal = item.price * item.quantity;
                            html += `
                                <tr style="border-bottom: 1px solid #e5e7eb;">
                                    <td style="padding: 8px;">
                                        <div style="font-weight: 500; color: #111827; font-size: 0.875rem;">${item.name}</div>
                                        ${item.color ? `<div style="color: #6b7280; font-size: 0.75rem;">–¶–≤–µ—Ç: ${item.color}</div>` : ''}
                                        ${item.memory ? `<div style="color: #6b7280; font-size: 0.75rem;">–ü–∞–º—è—Ç—å: ${item.memory}</div>` : ''}
                                        ${item.sim ? `<div style="color: #6b7280; font-size: 0.75rem;">SIM: ${item.sim}</div>` : ''}
                                        ${item.ram ? `<div style="color: #6b7280; font-size: 0.75rem;">RAM: ${item.ram}</div>` : ''}
                                    </td>
                                    <td style="padding: 8px; text-align: right; color: #6b7280; font-size: 0.875rem;">${item.price.toLocaleString()} ‚ÇΩ</td>
                                    <td style="padding: 8px; text-align: center; color: #6b7280; font-size: 0.875rem;">${item.quantity}</td>
                                    <td style="padding: 8px; text-align: right; font-weight: 500; color: #111827; font-size: 0.875rem;">${itemTotal.toLocaleString()} ‚ÇΩ</td>
                                </tr>
                            `;
                        });
                        
                        html += `
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        `;
                    });
                    
                    html += '</div>';
                    content.innerHTML = html;
                } else {
                    content.innerHTML = '<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤</p>';
                }
            })
            .catch(error => {
                content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤: ${error.message}</p>`;
            });
        }
        
        function toggleOrderItems(orderId) {
            const itemsDiv = document.getElementById(`order-items-${orderId}`);
            const arrow = document.getElementById(`order-arrow-${orderId}`);
            
            if (!itemsDiv || !arrow) return;
            
            if (itemsDiv.style.display === 'none' || !itemsDiv.style.display) {
                itemsDiv.style.display = 'block';
                arrow.style.transform = 'rotate(180deg)';
            } else {
                itemsDiv.style.display = 'none';
                arrow.style.transform = 'rotate(0deg)';
            }
        }
        
        function loadProducts() {
            const content = document.getElementById('products-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤...</p>';
            
               console.log('üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–æ–≤–∞—Ä—ã —Å limit=1000 –≤ admin —Ä–µ–∂–∏–º–µ...');
               fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                    let html = `<div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <h4>üìä –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${products.length}</h4>
                        <p><strong>–° SKU:</strong> ${products.filter(p => p.sku).length}</p>
                        <p><strong>–ë–µ–∑ SKU:</strong> ${products.filter(p => !p.sku).length}</p>
                    </div>`;
                    html += `<div class="product-grid">`;
                    products.forEach(product => {
                        html += `
                            <div class="product-card">
                                <h3>${product.name}</h3>
                                <p><strong>ID:</strong> ${product.id}</p>
                                <p><strong>SKU:</strong> ${product.sku || '–ù–µ—Ç SKU'}</p>
                                <p><strong>–ë—Ä–µ–Ω–¥:</strong> ${product.brand}</p>
                                <p><strong>–ú–æ–¥–µ–ª—å:</strong> ${product.model}</p>
                                <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${product.level_0 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                <p><strong>–°–µ—Ä–∏—è:</strong> ${product.level_1 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                <p><strong>–ú–æ–¥–µ–ª—å:</strong> ${product.level_2 || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</p>
                                ${product.color ? `<p><strong>–¶–≤–µ—Ç:</strong> ${product.color}</p>` : ''}
                                ${product.disk ? `<p><strong>–ü–∞–º—è—Ç—å:</strong> ${product.disk}</p>` : ''}
                                ${product.sim_config ? `<p><strong>SIM:</strong> ${product.sim_config}</p>` : ''}
                                <p><strong>–¶–µ–Ω–∞:</strong> ${product.price} ${product.currency}</p>
                                <p><strong>–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:</strong> ${product.is_available ? '‚úÖ –í –Ω–∞–ª–∏—á–∏–∏' : '‚ùå –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}</p>
                                <div style="margin-top: 15px; display: flex; gap: 10px;">
                                    <button onclick="showEditProductForm(${product.id})" class="btn btn-primary" style="flex: 1; padding: 10px 16px; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                        </svg>
                                        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                    <button onclick="deleteProduct(${product.id}, '${product.name}')" class="btn btn-danger" style="flex: 1; padding: 10px 16px; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <polyline points="3 6 5 6 21 6"></polyline>
                                            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                            <line x1="10" y1="11" x2="10" y2="17"></line>
                                            <line x1="14" y1="11" x2="14" y2="17"></line>
                                        </svg>
                                        –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                        `;
                    });
                    html += `</div>`;
                    content.innerHTML = html;
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤: ${error.message}</p>`;
                });
        }
        
        function showAddProductForm() {
            const content = document.getElementById('products-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                            <div class="form-group">
                                <label for="product-name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ *:</label>
                                <input type="text" id="product-name" placeholder="iPhone 16 Pro" required>
                            </div>
                            <div class="form-group">
                                <label for="product-brand">–ë—Ä–µ–Ω–¥ *:</label>
                                <select id="product-brand" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –±—Ä–µ–Ω–¥...</option>
                                    <option value="Apple">Apple</option>
                                    <option value="Samsung">Samsung</option>
                                    <option value="Google">Google</option>
                                    <option value="Lenovo">Lenovo</option>
                                    <option value="ASUS">ASUS</option>
                                    <option value="Sony">Sony</option>
                                    <option value="Xiaomi">Xiaomi</option>
                                    <option value="Huawei">Huawei</option>
                                    <option value="OnePlus">OnePlus</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="product-model">–ú–æ–¥–µ–ª—å *:</label>
                                <input type="text" id="product-model" placeholder="iPhone 16 Pro" required>
                            </div>
                            <div class="form-group">
                                <label for="product-sku">SKU (–∞—Ä—Ç–∏–∫—É–ª):</label>
                                <input type="text" id="product-sku" placeholder="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è">
                                <small style="color: #666;">–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</small>
                            </div>
                        </div>
                        
                        <div>
                            <h4>üí∞ –¶–µ–Ω–∞ –∏ –Ω–∞–ª–∏—á–∏–µ</h4>
                            <div class="form-group">
                                <label for="product-price">–¶–µ–Ω–∞ (—Ä—É–±.) *:</label>
                                <input type="number" id="product-price" step="0.01" placeholder="0.00" required>
                            </div>
                            <div class="form-group">
                                <label for="product-old-price">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞ (—Ä—É–±.):</label>
                                <input type="number" id="product-old-price" step="0.01" placeholder="0.00">
                            </div>
                            <div class="form-group">
                                <label for="product-stock">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ:</label>
                                <input type="number" id="product-stock" placeholder="0" min="0">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="product-available" checked> 
                                    –¢–æ–≤–∞—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h4>
                        <div class="form-group">
                            <label for="product-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="product-description" placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞..." rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="product-specifications">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (JSON):</label>
                            <textarea id="product-specifications" placeholder='{"color": "black", "memory": "128GB", "sim_type": "eSIM"}' rows="4"></textarea>
                            <small style="color: #666;">–í —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫</small>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üìÇ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label for="product-level0">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è *:</label>
                                <select id="product-level0" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—é...</option>
                                    <option value="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã">–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã</option>
                                    <option value="–ü–ª–∞–Ω—à–µ—Ç—ã">–ü–ª–∞–Ω—à–µ—Ç—ã</option>
                                    <option value="–ù–æ—É—Ç–±—É–∫–∏">–ù–æ—É—Ç–±—É–∫–∏</option>
                                    <option value="–£–º–Ω—ã–µ —á–∞—Å—ã">–£–º–Ω—ã–µ —á–∞—Å—ã</option>
                                    <option value="–ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏">–ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏</option>
                                    <option value="–£–º–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏">–£–º–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏</option>
                                    <option value="–£–º–Ω—ã–µ –±—Ä–∞—Å–ª–µ—Ç—ã">–£–º–Ω—ã–µ –±—Ä–∞—Å–ª–µ—Ç—ã</option>
                                    <option value="–ù–∞—É—à–Ω–∏–∫–∏">–ù–∞—É—à–Ω–∏–∫–∏</option>
                                    <option value="–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã</option>
                                    <option value="–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è –∫–æ–Ω—Å–æ–ª–µ–π">–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –¥–ª—è –∫–æ–Ω—Å–æ–ª–µ–π</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="product-level1">–°–µ—Ä–∏—è:</label>
                                <input type="text" id="product-level1" placeholder="16 Series">
                            </div>
                            <div class="form-group">
                                <label for="product-level2">–ú–æ–¥–µ–ª—å:</label>
                                <input type="text" id="product-level2" placeholder="iPhone 16 Pro">
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üé® –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–æ–≤–∞—Ä–∞</h4>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label for="product-color">–¶–≤–µ—Ç:</label>
                                <input type="text" id="product-color" placeholder="black, white, blue">
                            </div>
                            <div class="form-group">
                                <label for="product-disk">–ü–∞–º—è—Ç—å:</label>
                                <input type="text" id="product-disk" placeholder="128GB, 256GB, 512GB">
                            </div>
                            <div class="form-group">
                                <label for="product-sim">SIM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:</label>
                                <input type="text" id="product-sim" placeholder="Single SIM, Dual SIM">
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <h4>üñºÔ∏è –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h4>
                        <div class="form-group">
                            <label for="product-images">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):</label>
                            <textarea id="product-images" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg" rows="3"></textarea>
                            <small style="color: #666;">–ö–∞–∂–¥—ã–π URL —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º.</small>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="addProduct()" class="btn btn-success" style="padding: 12px 30px; font-size: 16px;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä
                        </button>
                        <button onclick="loadProducts()" class="btn btn-secondary" style="margin-left: 10px;">
                            ‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                        </button>
                    </div>
                </div>
            `;
        }
        
        function addProduct() {
            // –í–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
            const name = document.getElementById('product-name').value.trim();
            const brand = document.getElementById('product-brand').value;
            const model = document.getElementById('product-model').value.trim();
            const price = parseFloat(document.getElementById('product-price').value);
            const level0 = document.getElementById('product-level0').value;
            
            if (!name || !brand || !model || isNaN(price) || !level0) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è (–æ—Ç–º–µ—á–µ–Ω—ã *)');
                return;
            }
            
            // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
            const productData = {
                name: name,
                brand: brand,
                model: model,
                description: document.getElementById('product-description').value.trim(),
                price: price,
                old_price: parseFloat(document.getElementById('product-old-price').value) || price,
                stock: parseInt(document.getElementById('product-stock').value) || 0,
                is_available: document.getElementById('product-available').checked,
                sku: document.getElementById('product-sku').value.trim() || `${brand.slice(0,3).toUpperCase()}${Date.now()}`,
                level0: level0,  // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: level0 –≤–º–µ—Å—Ç–æ level_0
                level1: document.getElementById('product-level1').value.trim() || null,
                level2: document.getElementById('product-level2').value.trim() || null,
                color: document.getElementById('product-color').value.trim() || null,
                disk: document.getElementById('product-disk').value.trim() || null,
                sim_config: document.getElementById('product-sim').value.trim() || null
            };
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
            const specsText = document.getElementById('product-specifications').value.trim();
            if (specsText) {
                try {
                    productData.specifications = JSON.parse(specsText);
                } catch (e) {
                    alert('‚ùå –û—à–∏–±–∫–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ (JSON). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å.');
                    return;
                }
            }
            
            // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const imagesText = document.getElementById('product-images').value.trim();
            if (imagesText) {
                const imageUrls = imagesText.split('\n')
                    .map(url => url.trim())
                    .filter(url => url && url.startsWith('http'));
                
                if (imageUrls.length > 0) {
                    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–∞–∫ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –¥–ª—è API
                    productData.images = imageUrls.map(url => ({ url: url }));
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const button = document.querySelector('button[onclick="addProduct()"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...';
            button.disabled = true;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å
            fetch('/import-single-product', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(productData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –¢–æ–≤–∞—Ä "${result.message}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!\nSKU: ${result.sku}\nID: ${result.product_id}`);
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
            })
            .finally(() => {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        function loadPricesTable() {
            const container = document.getElementById('prices-table-container');
            container.innerHTML = '<p style="color: #666;">–ó–∞–≥—Ä—É–∑–∫–∞ —Ü–µ–Ω...</p>';
            
               fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                // –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–≤–∞—Ä—ã —Å SKU –∏ –∏–∑–≤–ª–µ–∫–∞–µ–º —Ü–µ–Ω—ã
                const productsWithPrices = products
                    .filter(p => p.sku)
                    .map(product => {
                        // –ü–æ–ª—É—á–∞–µ–º is_parse –∏–∑ price_storage —á–µ—Ä–µ–∑ API
                        // –í–∞–∂–Ω–æ: –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä–æ–≥–æ –Ω–∞ boolean, —Ç–∞–∫ –∫–∞–∫ false —Ç–æ–∂–µ –≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
                        let is_parse = true; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é true
                        if (typeof product.is_parse === 'boolean') {
                            is_parse = product.is_parse;
                        } else if (product.is_parse !== undefined && product.is_parse !== null) {
                            // –ï—Å–ª–∏ –ø—Ä–∏—à–ª–æ –Ω–µ boolean, –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
                            is_parse = Boolean(product.is_parse);
                        }
                        return {
                            sku: product.sku,
                            name: product.name,
                            brand: product.brand,
                            model: product.model,
                            current_price: product.price || 0,
                            old_price: product.old_price || product.price || 0,
                            is_parse: is_parse
                        };
                    })
                    .sort((a, b) => a.sku.localeCompare(b.sku));
                
                if (productsWithPrices.length === 0) {
                    container.innerHTML = '<p style="color: #666;">–¢–æ–≤–∞—Ä—ã —Å —Ü–µ–Ω–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>';
                    return;
                }
                
                let html = `
                    <div style="overflow-x: auto; margin-bottom: 20px;">
                        <table style="width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.1);">
                            <thead>
                                <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #111827; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">SKU</th>
                                    <th style="padding: 12px; text-align: left; font-weight: 600; color: #111827; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">–¢–æ–≤–∞—Ä</th>
                                    <th style="padding: 12px; text-align: right; font-weight: 600; color: #111827; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞</th>
                                    <th style="padding: 12px; text-align: right; font-weight: 600; color: #111827; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞</th>
                                    <th style="padding: 12px; text-align: center; font-weight: 600; color: #111827; font-size: 0.875rem; text-transform: uppercase; letter-spacing: 0.5px;">–ü–∞—Ä—Å–∏—Ç—å</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                productsWithPrices.forEach((item, index) => {
                    html += `
                        <tr style="border-bottom: 1px solid #e5e7eb; transition: background 0.2s;" onmouseenter="this.style.background='#f9fafb'" onmouseleave="this.style.background='white'">
                            <td style="padding: 12px; font-weight: 500; color: #111827; font-size: 0.875rem;">${item.sku}</td>
                            <td style="padding: 12px; color: #6b7280; font-size: 0.875rem;">
                                <div style="font-weight: 500; color: #111827;">${item.name || `${item.brand} ${item.model}`}</div>
                            </td>
                            <td style="padding: 12px; text-align: right;">
                                <input type="number" 
                                       id="price-${item.sku}" 
                                       value="${item.current_price}" 
                                       step="0.01" 
                                       min="0"
                                       data-sku="${item.sku}"
                                       data-original-price="${item.current_price}"
                                       style="width: 120px; padding: 6px 10px; border: 1px solid #e5e7eb; border-radius: 6px; text-align: right; font-size: 0.875rem; transition: all 0.2s;"
                                       onfocus="this.style.borderColor='#007AFF'; this.style.boxShadow='0 0 0 3px rgba(0,122,255,0.1)'"
                                       onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
                                       onchange="markPriceChanged('${item.sku}')">
                            </td>
                            <td style="padding: 12px; text-align: right;">
                                <input type="number" 
                                       id="old-price-${item.sku}" 
                                       value="${item.old_price}" 
                                       step="0.01" 
                                       min="0"
                                       data-sku="${item.sku}"
                                       data-original-old-price="${item.old_price}"
                                       style="width: 120px; padding: 6px 10px; border: 1px solid #e5e7eb; border-radius: 6px; text-align: right; font-size: 0.875rem; transition: all 0.2s;"
                                       onfocus="this.style.borderColor='#007AFF'; this.style.boxShadow='0 0 0 3px rgba(0,122,255,0.1)'"
                                       onblur="this.style.borderColor='#e5e7eb'; this.style.boxShadow='none'"
                                       onchange="markPriceChanged('${item.sku}')">
                            </td>
                            <td style="padding: 12px; text-align: center;">
                                <input type="checkbox" 
                                       id="is-parse-${item.sku}" 
                                       ${item.is_parse === true ? 'checked' : ''}
                                       data-sku="${item.sku}"
                                       data-original-is-parse="${item.is_parse === true ? 'true' : 'false'}"
                                       style="width: 20px; height: 20px; cursor: pointer;"
                                       onchange="markPriceChanged('${item.sku}')"
                                       title="–ü–∞—Ä—Å–∏—Ç—å —Ü–µ–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ —Ç–æ–≤–∞—Ä–∞">
                            </td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button onclick="saveAllPrices()" class="btn btn-success" style="display: inline-flex; align-items: center; gap: 6px; font-weight: 500; padding: 10px 24px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                <polyline points="7 3 7 8 15 8"></polyline>
                            </svg>
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
                        </button>
                    </div>
                `;
                
                container.innerHTML = html;
                })
                .catch(error => {
                container.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–µ–Ω: ${error.message}</p>`;
            });
        }
        
        const changedPrices = new Set();
        
        function markPriceChanged(sku) {
            changedPrices.add(sku);
        }
        
        function saveAllPrices() {
            const resultDiv = document.getElementById('price-result');
            resultDiv.innerHTML = '<p style="color: #666;">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π...</p>';
            
            const pricesToUpdate = [];
            const allInputs = document.querySelectorAll('input[id^="price-"]');
            
            // –°–æ–±–∏—Ä–∞–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã
            allInputs.forEach(input => {
                if (input.id.startsWith('price-') && !input.id.startsWith('old-price-') && !input.id.startsWith('is-parse-')) {
                    const sku = input.dataset.sku;
                    const originalPrice = parseFloat(input.dataset.originalPrice || 0);
                    const newPrice = parseFloat(input.value);
                    const oldPriceInput = document.getElementById(`old-price-${sku}`);
                    const originalOldPrice = oldPriceInput ? parseFloat(oldPriceInput.dataset.originalOldPrice || 0) : originalPrice;
                    const oldPrice = oldPriceInput ? parseFloat(oldPriceInput.value) : newPrice;
                    
                    // –ü–æ–ª—É—á–∞–µ–º is_parse
                    const isParseCheckbox = document.getElementById(`is-parse-${sku}`);
                    const originalIsParse = isParseCheckbox ? (isParseCheckbox.dataset.originalIsParse === 'true') : true;
                    const isParse = isParseCheckbox ? isParseCheckbox.checked : true;
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –ª–∏ —Ü–µ–Ω–∞ –∏–ª–∏ is_parse
                    const priceChanged = Math.abs(newPrice - originalPrice) > 0.01;
                    const oldPriceChanged = oldPriceInput && Math.abs(oldPrice - originalOldPrice) > 0.01;
                    const isParseChanged = isParse !== originalIsParse;
                    
                    if ((priceChanged || oldPriceChanged || isParseChanged) && !isNaN(newPrice) && newPrice >= 0) {
                        pricesToUpdate.push({
                            sku: sku,
                            price: newPrice,
                            old_price: oldPrice || newPrice,
                            is_parse: isParse
                        });
                    }
                }
            });
            
            if (pricesToUpdate.length === 0) {
                resultDiv.innerHTML = '<p class="status-warning">‚ö†Ô∏è –ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è</p>';
                return;
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ü–µ–Ω—ã
            let saved = 0;
            let errors = 0;
            const errorMessages = [];
            
            Promise.all(
                pricesToUpdate.map(priceData => 
                    fetch('/update-price', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(priceData)
                    })
                    .then(response => {
                        if (!response.ok) {
                            return response.json().then(err => {
                                throw new Error(err.detail || err.message || '–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è');
                            });
                        }
                        return response.json();
                    })
                    .then(result => {
                        if (result.message && result.message.includes('—É—Å–ø–µ—à–Ω–æ')) {
                            saved++;
                        } else {
                            errors++;
                            errorMessages.push(`${priceData.sku}: ${result.detail || result.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞'}`);
                        }
                    })
                    .catch(error => {
                        errors++;
                        const errorMsg = error.message || error.toString();
                        errorMessages.push(`${priceData.sku}: ${errorMsg}`);
                    })
                )
            )
            .then(() => {
                if (errors === 0) {
                    resultDiv.innerHTML = `<p class="status-success">‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ ${saved} —Ü–µ–Ω!</p>`;
                    changedPrices.clear();
                    // –û–±–Ω–æ–≤–ª—è–µ–º original –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
                    pricesToUpdate.forEach(priceData => {
                        const priceInput = document.getElementById(`price-${priceData.sku}`);
                        const oldPriceInput = document.getElementById(`old-price-${priceData.sku}`);
                        const isParseCheckbox = document.getElementById(`is-parse-${priceData.sku}`);
                        if (priceInput) {
                            priceInput.dataset.originalPrice = priceData.price;
                        }
                        if (oldPriceInput) {
                            oldPriceInput.dataset.originalOldPrice = priceData.old_price;
                        }
                        if (isParseCheckbox) {
                            isParseCheckbox.dataset.originalIsParse = priceData.is_parse;
                        }
                    });
                } else {
                    const errorList = errorMessages.length > 20 
                        ? errorMessages.slice(0, 20).map(msg => `<li>${msg}</li>`).join('') + `<li>... –∏ –µ—â–µ ${errorMessages.length - 20} –æ—à–∏–±–æ–∫</li>`
                        : errorMessages.map(msg => `<li>${msg}</li>`).join('');
                    
                    resultDiv.innerHTML = `
                        <p class="status-warning">‚ö†Ô∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ ${saved} —Ü–µ–Ω, –æ—à–∏–±–æ–∫: ${errors}</p>
                        ${errorMessages.length > 0 ? `<div style="margin-top: 10px; padding: 10px; background: #fef2f2; border-radius: 6px; font-size: 0.875rem; max-height: 300px; overflow-y: auto;"><strong>–û—à–∏–±–∫–∏:</strong><ul style="margin: 5px 0 0 20px;">${errorList}</ul></div>` : ''}
                    `;
                }
            });
        }
        
        function uploadExcel() {
            const fileInput = document.getElementById('excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('upload-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('upload-result').innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞...</p>';
            
            fetch('/api/excel/import/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                if (result.message && (result.message.includes('—É—Å–ø–µ—à–Ω–æ') || result.message.includes('–∑–∞–≤–µ—Ä—à–µ–Ω'))) {
                    let messageClass = 'status-success';
                    let icon = '‚úÖ';
                    let mainMessage = '–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
                    
                    // –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏, –º–µ–Ω—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å—Ç–∏–ª—å
                    if (result.errors && result.errors.length > 0) {
                        if (result.added && result.added > 0) {
                            messageClass = 'status-warning';
                            icon = '‚ö†Ô∏è';
                            mainMessage = '–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏';
                        } else {
                            messageClass = 'status-error';
                            icon = '‚ùå';
                            mainMessage = '–ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —Å –æ—à–∏–±–∫–∞–º–∏';
                        }
                    }
                    
                    let fullMessage = `${icon} ${mainMessage}`;
                    if (result.added) {
                        fullMessage += `<br>üì¶ –î–æ–±–∞–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${result.added}`;
                    }
                    if (result.errors && result.errors.length > 0) {
                        fullMessage += `<br>‚ö†Ô∏è –û—à–∏–±–æ–∫: ${result.errors.length}`;
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫
                        if (result.errors.length <= 3) {
                            fullMessage += '<br><small>';
                            result.errors.forEach(error => {
                                fullMessage += `‚Ä¢ ${error}<br>`;
                            });
                            fullMessage += '</small>';
                        } else {
                            fullMessage += `<br><small>–ü–æ–∫–∞–∑–∞–Ω—ã –ø–µ—Ä–≤—ã–µ 3 –∏–∑ ${result.errors.length} –æ—à–∏–±–æ–∫</small>`;
                        }
                    }
                    
                    document.getElementById('upload-result').innerHTML = `<p class="${messageClass}">${fullMessage}</p>`;
                } else {
                    document.getElementById('upload-result').innerHTML = `<p class="status-error">‚ùå ${result.detail || result.message}</p>`;
                }
            })
            .catch(error => {
                document.getElementById('upload-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function uploadPriceExcel() {
            const fileInput = document.getElementById('price-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('price-excel-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å —Ü–µ–Ω–∞–º–∏</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('price-excel-result').innerHTML = '<p>üìä –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–µ–Ω...</p>';
            
            fetch('/import-prices', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div class="status-success">';
                html += `‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω–æ!<br>`;
                html += `<strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</strong> ${result.total_processed || 0} —Å—Ç—Ä–æ–∫<br>`;
                html += `<strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> ${result.updated || 0} —Ü–µ–Ω<br>`;
                
                if (result.not_found && result.not_found.length > 0) {
                    html += `<br><strong>‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω—ã —Ç–æ–≤–∞—Ä—ã:</strong><br>`;
                    result.not_found.forEach(item => {
                        html += `‚Ä¢ ${item}<br>`;
                    });
                }
                
                if (result.errors && result.errors.length > 0) {
                    html += `<br><strong>‚ùå –û—à–∏–±–∫–∏:</strong><br>`;
                    result.errors.forEach(error => {
                        html += `‚Ä¢ ${error}<br>`;
                    });
                }
                
                html += '</div>';
                document.getElementById('price-excel-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('price-excel-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function uploadImagesExcel() {
            const fileInput = document.getElementById('images-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                document.getElementById('images-excel-result').innerHTML = '<p class="status-error">‚ùå –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª Excel —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏</p>';
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            document.getElementById('images-excel-result').innerHTML = '<p>üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>';
            
            fetch('/api/excel/import/images', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div class="status-success">';
                html += `‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∞!<br>`;
                html += `<strong>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ:</strong> ${result.total_processed || 0} –∑–∞–ø–∏—Å–µ–π<br>`;
                html += `<strong>–î–æ–±–∞–≤–ª–µ–Ω–æ:</strong> ${result.added || 0} –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br>`;
                html += `<strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> ${result.updated || 0} —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π<br>`;
                
                if (result.errors && result.errors.length > 0) {
                    html += `<br><strong>‚ùå –û—à–∏–±–∫–∏:</strong><br>`;
                    result.errors.forEach(error => {
                        html += `‚Ä¢ ${error}<br>`;
                    });
                }
                
                html += '</div>';
                document.getElementById('images-excel-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('images-excel-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function openManualPriceManager() {
            window.open('http://localhost:8000/webapp', '_blank');
        }
        
        function showEditProductForm(productId) {
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞
            fetch('/all-products')
                .then(response => response.json())
                .then(products => {
                    const product = products.find(p => p.id === productId);
                    if (!product) {
                        alert('‚ùå –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω');
                        return;
                    }
                    
                    const content = document.getElementById('products-content');
                    content.innerHTML = `
                        <div class="product-card">
                            <h3 style="display: flex; align-items: center; gap: 8px;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä
                            </h3>
                            <form id="editProductForm" onsubmit="updateProduct(event, ${productId})">
                                <div class="form-group">
                                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞*</label>
                                    <input type="text" id="edit_name" value="${product.name || ''}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–û–ø–∏—Å–∞–Ω–∏–µ</label>
                                    <textarea id="edit_description" rows="3">${product.description || ''}</textarea>
                                </div>
                                
                                <div class="form-group">
                                    <label>–ë—Ä–µ–Ω–¥</label>
                                    <input type="text" id="edit_brand" value="${product.brand || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ú–æ–¥–µ–ª—å</label>
                                    <input type="text" id="edit_model" value="${product.model || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (level0)*</label>
                                    <input type="text" id="edit_level_0" value="${product.level_0 || ''}" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è (level1)</label>
                                    <input type="text" id="edit_level_1" value="${product.level_1 || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (level2)</label>
                                    <input type="text" id="edit_level_2" value="${product.level_2 || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–¶–≤–µ—Ç</label>
                                    <input type="text" id="edit_color" value="${product.color || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ü–∞–º—è—Ç—å (disk)</label>
                                    <input type="text" id="edit_disk" value="${product.disk || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>SIM –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</label>
                                    <input type="text" id="edit_sim_config" value="${product.sim_config || ''}">
                                </div>
                                
                                <div class="form-group">
                                    <label>–¶–µ–Ω–∞*</label>
                                    <input type="number" id="edit_price" value="${product.price || 0}" step="0.01" required>
                                </div>
                                
                                <div class="form-group">
                                    <label>–°—Ç–∞—Ä–∞—è —Ü–µ–Ω–∞</label>
                                    <input type="number" id="edit_old_price" value="${product.old_price || ''}" step="0.01">
                                </div>
                                
                                <div class="form-group">
                                    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ</label>
                                    <input type="number" id="edit_stock" value="${product.stock || 0}">
                                </div>
                                
                                <div class="form-group">
                                    <label>
                                        <input type="checkbox" id="edit_is_available" ${product.is_available ? 'checked' : ''}>
                                        –î–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏
                                    </label>
                                </div>
                                
                                <div class="form-group">
                                    <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)</label>
                                    <textarea id="edit_image_urls" rows="4">${product.image_urls || ''}</textarea>
                                </div>
                                
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn btn-success" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                            <polyline points="7 3 7 8 15 8"></polyline>
                                        </svg>
                                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                                    </button>
                                    <button type="button" onclick="loadProducts()" class="btn btn-secondary" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <line x1="18" y1="6" x2="6" y2="18"></line>
                                            <line x1="6" y1="6" x2="18" y2="18"></line>
                                        </svg>
                                        –û—Ç–º–µ–Ω–∞
                                    </button>
                                </div>
                            </form>
                        </div>
                    `;
                })
                .catch(error => {
                    alert(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                });
        }
        
        function updateProduct(event, productId) {
            event.preventDefault();
            
            const productData = {
                name: document.getElementById('edit_name').value,
                description: document.getElementById('edit_description').value,
                brand: document.getElementById('edit_brand').value,
                model: document.getElementById('edit_model').value,
                level_0: document.getElementById('edit_level_0').value,
                level_1: document.getElementById('edit_level_1').value,
                level_2: document.getElementById('edit_level_2').value,
                color: document.getElementById('edit_color').value,
                disk: document.getElementById('edit_disk').value,
                sim_config: document.getElementById('edit_sim_config').value,
                price: parseFloat(document.getElementById('edit_price').value),
                old_price: document.getElementById('edit_old_price').value ? parseFloat(document.getElementById('edit_old_price').value) : null,
                stock: parseInt(document.getElementById('edit_stock').value),
                is_available: document.getElementById('edit_is_available').checked,
                image_urls: document.getElementById('edit_image_urls').value
            };
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const submitBtn = event.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
            fetch(`/products/${productId}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(productData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ ${result.message}`);
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                submitBtn.disabled = false;
                submitBtn.textContent = 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è';
            });
        }

        function deleteProduct(productId, productName) {
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–∏—è
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä "${productName}"?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!`)) {
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            const content = document.getElementById('products-content');
            const originalContent = content.innerHTML;
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
            fetch(`/products/${productId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ ${result.message}`);
                    // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤
                    loadProducts();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    content.innerHTML = originalContent;
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞: ${error.message}`);
                content.innerHTML = originalContent;
            });
        }
        
        function downloadCurrentProducts() {
            // –°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã –≤ Excel
            window.location.href = '/api/excel/export/products';
        }
        
        function showUploadProductsForm() {
            const content = document.getElementById('products-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>üì§ –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ —á–µ—Ä–µ–∑ Excel</h3>
                    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <p><strong>üí° –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>–ï—Å–ª–∏ <strong>SKU —Å—É—â–µ—Å—Ç–≤—É–µ—Ç</strong> ‚Üí —Ç–æ–≤–∞—Ä –±—É–¥–µ—Ç <strong>–æ–±–Ω–æ–≤–ª–µ–Ω</strong></li>
                            <li>–ï—Å–ª–∏ <strong>SKU –Ω–æ–≤—ã–π</strong> ‚Üí —Ç–æ–≤–∞—Ä –±—É–¥–µ—Ç <strong>–¥–æ–±–∞–≤–ª–µ–Ω</strong></li>
                            <li>SKU –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º - —Å–∏—Å—Ç–µ–º–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                        </ul>
                        <p style="margin-top: 10px;"><strong>üì• –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong></p>
                        <ol style="margin-left: 20px;">
                            <li>–ù–∞–∂–º–∏—Ç–µ "–°–∫–∞—á–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —Ç–æ–≤–∞—Ä—ã" —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å Excel —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏</li>
                            <li>–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ</li>
                            <li>–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª –æ–±—Ä–∞—Ç–Ω–æ</li>
                        </ol>
                    </div>
                    <form id="uploadProductsForm" onsubmit="uploadAndUpdateProducts(event)">
                        <div class="form-group">
                            <label>–í—ã–±–µ—Ä–∏—Ç–µ Excel —Ñ–∞–π–ª</label>
                            <input type="file" id="products-excel-file" accept=".xlsx,.xls" required>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="submit" class="btn btn-success" style="flex: 1;">üì§ –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏ –æ–±–Ω–æ–≤–∏—Ç—å</button>
                            <button type="button" onclick="loadProducts()" class="btn btn-secondary" style="flex: 1;">‚ùå –û—Ç–º–µ–Ω–∞</button>
                        </div>
                    </form>
                    <div id="upload-products-result" style="margin-top: 20px;"></div>
                </div>
            `;
        }
        
        function uploadAndUpdateProducts(event) {
            event.preventDefault();
            
            const fileInput = document.getElementById('products-excel-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('upload-products-result').innerHTML = '<p>‚è≥ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞...</p>';
            
            fetch('/api/excel/update-or-create/products', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                let html = '<div style="padding: 15px; border-radius: 8px; background: #f8f9fa;">';
                
                if (result.success) {
                    html += `<p class="status-success">‚úÖ ${result.message}</p>`;
                    html += `<p><strong>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</strong></p>`;
                    html += `<ul style="margin-left: 20px;">`;
                    html += `<li>‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤: <strong>${result.added}</strong></li>`;
                    html += `<li>‚úèÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö: <strong>${result.updated}</strong></li>`;
                    html += `<li>üìù –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: <strong>${result.total_processed}</strong></li>`;
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (result.images_added !== undefined || result.images_updated !== undefined) {
                        html += `<li>üñºÔ∏è –î–æ–±–∞–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: <strong>${result.images_added || 0}</strong></li>`;
                        html += `<li>üñºÔ∏è –û–±–Ω–æ–≤–ª–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: <strong>${result.images_updated || 0}</strong></li>`;
                    }
                    
                    html += `</ul>`;
                    
                    if (result.errors && result.errors.length > 0) {
                        html += `<br><strong>‚ö†Ô∏è –û—à–∏–±–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ (${result.errors.length}):</strong><br>`;
                        html += `<div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px;">`;
                        result.errors.forEach(error => {
                            html += `‚Ä¢ ${error}<br>`;
                        });
                        html += '</div>';
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –µ—Å–ª–∏ –µ—Å—Ç—å
                    if (result.images_errors && result.images_errors.length > 0) {
                        html += `<br><strong>‚ö†Ô∏è –û—à–∏–±–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (${result.images_errors.length}):</strong><br>`;
                        html += `<div style="max-height: 200px; overflow-y: auto; background: white; padding: 10px; border-radius: 5px;">`;
                        result.images_errors.forEach(error => {
                            html += `‚Ä¢ ${error}<br>`;
                        });
                        html += '</div>';
                    }
                    
                    html += '<br><button onclick="loadProducts()" class="btn btn-primary">üîÑ –û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</button>';
                } else {
                    html += `<p class="status-error">‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}</p>`;
                }
                
                html += '</div>';
                document.getElementById('upload-products-result').innerHTML = html;
            })
            .catch(error => {
                document.getElementById('upload-products-result').innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</p>`;
            });
        }
        
        function loadCategories() {
            const content = document.getElementById('categories-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...</p>';
            
            fetch('/categories')
                .then(response => response.json())
                .then(categories => {
                    let html = `<div class="product-grid">`;
                    categories.forEach(category => {
                        html += `
                            <div class="product-card">
                                <h3>${category.name}</h3>
                                <p><strong>ID:</strong> ${category.id}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 0:</strong> ${category.level_0}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 1:</strong> ${category.level_1 || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <p><strong>–£—Ä–æ–≤–µ–Ω—å 2:</strong> ${category.level_2 || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${category.description || '–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è'}</p>
                                <p><strong>–ò–∫–æ–Ω–∫–∞:</strong> ${category.icon || '–ù–µ—Ç –∏–∫–æ–Ω–∫–∏'}</p>
                                <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤:</strong> ${category.product_count || 0}</p>
                            </div>
                        `;
                    });
                    html += `</div>`;
                    content.innerHTML = html;
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: ${error.message}</p>`;
                });
        }
        
        function showAddCategoryForm() {
            const content = document.getElementById('categories-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <h4>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                            <div class="form-group">
                                <label for="category-level0">–û—Å–Ω–æ–≤–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è *:</label>
                                <input type="text" id="category-level0" placeholder="–°–º–∞—Ä—Ç—Ñ–æ–Ω—ã" required>
                            </div>
                            <div class="form-group">
                                <label for="category-level1">–°–µ—Ä–∏—è:</label>
                                <input type="text" id="category-level1" placeholder="16 Series">
                            </div>
                            <div class="form-group">
                                <label for="category-level2">–ú–æ–¥–µ–ª—å:</label>
                                <input type="text" id="category-level2" placeholder="iPhone 16 Pro">
                            </div>
                        </div>
                        
                        <div>
                            <h4>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∏ –∏–∫–æ–Ω–∫–∞</h4>
                            <div class="form-group">
                                <label for="category-description">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
                                <textarea id="category-description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏..." rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="category-icon">–ò–∫–æ–Ω–∫–∞ (—ç–º–æ–¥–∑–∏):</label>
                                <input type="text" id="category-icon" placeholder="üì±" maxlength="2">
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="addCategory()" class="btn btn-success" style="padding: 12px 30px; font-size: 16px;">
                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é
                        </button>
                        <button onclick="loadCategories()" class="btn btn-secondary" style="margin-left: 10px;">
                            ‚Ü©Ô∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
                        </button>
                    </div>
                </div>
            `;
        }
        
        function addCategory() {
            const level0 = document.getElementById('category-level0').value.trim();
            const level1 = document.getElementById('category-level1').value.trim();
            const level2 = document.getElementById('category-level2').value.trim();
            const description = document.getElementById('category-description').value.trim();
            const icon = document.getElementById('category-icon').value.trim();
            
            if (!level0) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é');
                return;
            }
            
            const categoryData = {
                level_0: level0,
                level_1: level1 || null,
                level_2: level2 || null,
                description: description || null,
                icon: icon || null
            };
            
            const button = document.querySelector('button[onclick="addCategory()"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ...';
            button.disabled = true;
            
            fetch('/api/categories', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(categoryData)
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏—è "${level0}" —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!`);
                    loadCategories();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: ${error.message}`);
            })
            .finally(() => {
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        // Load orders on page load
        document.addEventListener('DOMContentLoaded', loadOrders);
        
        // --- Image Management Functions ---
        
        function loadAllImages() {
            const content = document.getElementById('images-content');
            content.innerHTML = '<p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π...</p>';
            
            fetch('/api/images')
                .then(response => response.json())
                .then(result => {
                    if (result.success && result.images) {
                        if (result.images.length === 0) {
                            content.innerHTML = '<p style="color: #666;">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤.</p>';
                            return;
                        }
                        
                        let html = `<div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                            <h4>üìä –í—Å–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${result.images.length}</h4>
                        </div>`;
                        
                        html += '<div class="product-grid">';
                        result.images.forEach(img => {
                            html += `
                                <div class="product-card">
                                    <h3>${img.level_2 || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</h3>
                                    <p><strong>–¶–≤–µ—Ç:</strong> ${img.color || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                    <p><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:</strong> ${img.images ? img.images.length : 0}</p>
                                    ${img.images && img.images.length > 0 ? `
                                        <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 8px;">
                                            ${img.images.slice(0, 4).map(url => `
                                                <img src="${url}" alt="Preview" style="width: 100%; height: 80px; object-fit: cover; border-radius: 4px; border: 1px solid #ddd;" onerror="this.src='/static/images/placeholder.jpg'">
                                            `).join('')}
                                            ${img.images.length > 4 ? `<div style="text-align: center; line-height: 80px; color: #666;">+${img.images.length - 4}</div>` : ''}
                                        </div>
                                    ` : '<p style="color: #999; font-style: italic;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>'}
                                    <div style="margin-top: 15px;">
                                        <button onclick="showEditImageForm('${img.level_2}', '${img.color}', ${img.id})" class="btn btn-primary" style="width: 100%; padding: 10px 16px; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                            –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                        </button>
                                    </div>
                                </div>
                            `;
                        });
                        html += '</div>';
                        content.innerHTML = html;
                    } else {
                        content.innerHTML = '<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>';
                    }
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}</p>`;
                });
        }
        
        function showAddImageForm() {
            const content = document.getElementById('images-content');
            content.innerHTML = `
                <div class="product-card">
                    <h3>‚ûï –î–æ–±–∞–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è —Ç–æ–≤–∞—Ä–∞</h3>
                    <form id="addImageForm" onsubmit="saveNewImages(event)">
                        <div class="form-group">
                            <label for="image-level2">–ú–æ–¥–µ–ª—å (level_2) *:</label>
                            <input type="text" id="image-level2" placeholder="iPhone 16 Pro" required>
                        </div>
                        <div class="form-group">
                            <label for="image-color">–¶–≤–µ—Ç *:</label>
                            <input type="text" id="image-color" placeholder="Black, White, Blue" required>
                        </div>
                        <div class="form-group">
                            <label for="image-urls">URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É) *:</label>
                            <textarea id="image-urls" rows="5" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg" required></textarea>
                            <small style="color: #666;">–ö–∞–∂–¥—ã–π URL —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º.</small>
                        </div>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="submit" class="btn btn-success" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                    <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                    <polyline points="7 3 7 8 15 8"></polyline>
                                </svg>
                                –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
                            </button>
                            <button type="button" onclick="loadAllImages()" class="btn btn-secondary" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                                –û—Ç–º–µ–Ω–∞
                            </button>
                        </div>
                    </form>
                </div>
            `;
        }
        
        function showEditImageForm(level_2, color, imageId) {
            const content = document.getElementById('images-content');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            fetch(`/api/images/${encodeURIComponent(level_2)}/${encodeURIComponent(color)}`)
                .then(response => response.json())
                .then(result => {
                    const currentImages = result.images || [];
                    const imagesText = currentImages.join('\n');
                    
                    content.innerHTML = `
                        <div class="product-card">
                            <h3 style="display: flex; align-items: center; gap: 8px;">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                                –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                            </h3>
                            <p><strong>–ú–æ–¥–µ–ª—å:</strong> ${level_2}</p>
                            <p><strong>–¶–≤–µ—Ç:</strong> ${color}</p>
                            <form id="editImageForm" onsubmit="saveImages(event, '${level_2}', '${color}')">
                                <div class="form-group">
                                    <label>URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É):</label>
                                    <textarea id="edit-image-urls" rows="8" placeholder="https://example.com/image1.jpg&#10;https://example.com/image2.jpg">${imagesText}</textarea>
                                    <small style="color: #666;">–ö–∞–∂–¥—ã–π URL —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –ü–µ—Ä–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º.</small>
                                </div>
                                ${currentImages.length > 0 ? `
                                    <div class="form-group">
                                        <label>–¢–µ–∫—É—â–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä):</label>
                                        <small style="color: #666; display: block; margin-bottom: 10px;">üí° –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞</small>
                                        <div id="image-preview-container" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-top: 10px;">
                                            ${currentImages.map((url, index) => `
                                                <div class="draggable-image" draggable="true" data-index="${index}" style="position: relative; cursor: move; transition: transform 0.2s; background: #f8f9fa; border-radius: 8px; padding: 8px; border: 1px solid #ddd;" 
                                                     ondragstart="handleDragStart(event, ${index})" 
                                                     ondragover="handleDragOver(event)" 
                                                     ondragleave="handleDragLeave(event)"
                                                     ondrop="handleDrop(event, ${index})" 
                                                     ondragend="handleDragEnd(event)"
                                                     onmouseenter="this.style.transform='scale(1.02)'"
                                                     onmouseleave="this.style.transform='scale(1)'">
                                                    <img src="${url}" alt="Image ${index + 1}" style="width: 100%; height: auto; max-height: 300px; object-fit: contain; border-radius: 4px; display: block;" onerror="this.src='/static/images/placeholder.jpg'">
                                                    <div style="position: absolute; top: 12px; left: 12px; background: rgba(0,0,0,0.7); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">${index + 1}</div>
                                                    <button type="button" onclick="removeImageFromList(${index})" class="btn btn-danger" style="position: absolute; top: 12px; right: 12px; padding: 6px; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                                            <line x1="18" y1="6" x2="6" y2="18"></line>
                                                            <line x1="6" y1="6" x2="18" y2="18"></line>
                                                        </svg>
                                                    </button>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                ` : ''}
                                <div style="display: flex; gap: 10px; margin-top: 20px;">
                                    <button type="submit" class="btn btn-success" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                                            <polyline points="7 3 7 8 15 8"></polyline>
                                        </svg>
                                        –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
                                    </button>
                                    <button type="button" onclick="loadAllImages()" class="btn btn-secondary" style="flex: 1; display: inline-flex; align-items: center; justify-content: center; gap: 6px; font-weight: 500;">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                            <line x1="18" y1="6" x2="6" y2="18"></line>
                                            <line x1="6" y1="6" x2="18" y2="18"></line>
                                        </svg>
                                        –û—Ç–º–µ–Ω–∞
                                    </button>
                                </div>
                            </form>
                        </div>
                    `;
                })
                .catch(error => {
                    content.innerHTML = `<p class="status-error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}</p>`;
                });
        }
        
        function saveNewImages(event) {
            event.preventDefault();
            
            const level_2 = document.getElementById('image-level2').value.trim();
            const color = document.getElementById('image-color').value.trim();
            const urlsText = document.getElementById('image-urls').value.trim();
            
            if (!level_2 || !color || !urlsText) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            const imageUrls = urlsText.split('\n')
                .map(url => url.trim())
                .filter(url => url && url.startsWith('http'));
            
            if (imageUrls.length === 0) {
                alert('‚ùå –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –≤–∞–ª–∏–¥–Ω–æ–µ URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è');
                return;
            }
            
            const button = event.target.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            button.disabled = true;
            
            fetch('/api/images', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    level_2: level_2,
                    color: color,
                    images: imageUrls
                })
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã!`);
                    loadAllImages();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    button.innerHTML = originalText;
                    button.disabled = false;
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}`);
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        function saveImages(event, level_2, color) {
            event.preventDefault();
            
            const urlsText = document.getElementById('edit-image-urls').value.trim();
            const imageUrls = urlsText.split('\n')
                .map(url => url.trim())
                .filter(url => url && url.startsWith('http'));
            
            const button = event.target.querySelector('button[type="submit"]');
            const originalText = button.innerHTML;
            button.innerHTML = '‚è≥ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...';
            button.disabled = true;
            
            fetch(`/api/images/${encodeURIComponent(level_2)}/${encodeURIComponent(color)}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    level_2: level_2,
                    color: color,
                    images: imageUrls
                })
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã!`);
                    loadAllImages();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                    button.innerHTML = originalText;
                    button.disabled = false;
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}`);
                button.innerHTML = originalText;
                button.disabled = false;
            });
        }
        
        function deleteImage(imageId, level_2, color) {
            if (!confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è "${level_2}" (${color})?\n\n–≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!`)) {
                return;
            }
            
            fetch(`/api/images/${imageId}`, {
                method: 'DELETE'
            })
            .then(response => response.json())
            .then(result => {
                if (result.success) {
                    alert(`‚úÖ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã!`);
                    loadAllImages();
                } else {
                    alert(`‚ùå –û—à–∏–±–∫–∞: ${result.detail || result.message}`);
                }
            })
            .catch(error => {
                alert(`‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${error.message}`);
            });
        }
        
        // --- Drag and Drop Functions ---
        let draggedIndex = null;
        
        function handleDragStart(event, index) {
            draggedIndex = index;
            event.dataTransfer.effectAllowed = 'move';
            event.currentTarget.classList.add('dragging');
            event.currentTarget.style.opacity = '0.5';
        }
        
        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
            const target = event.currentTarget;
            if (target.classList.contains('draggable-image') && target.dataset.index != draggedIndex) {
                target.classList.add('drag-over');
            }
        }
        
        function handleDragLeave(event) {
            event.currentTarget.classList.remove('drag-over');
        }
        
        function handleDragEnd(event) {
            event.currentTarget.style.opacity = '1';
            event.currentTarget.classList.remove('dragging');
            // –£–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫—É —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            document.querySelectorAll('.draggable-image').forEach(el => {
                el.classList.remove('drag-over');
                el.style.border = '';
            });
        }
        
        function handleDrop(event, dropIndex) {
            event.preventDefault();
            event.stopPropagation();
            
            const target = event.currentTarget;
            target.style.border = '';
            
            if (draggedIndex === null || draggedIndex === dropIndex) {
                return;
            }
            
            const textarea = document.getElementById('edit-image-urls');
            if (!textarea) return;
            
            const lines = textarea.value.split('\n').filter(line => line.trim());
            if (draggedIndex >= 0 && draggedIndex < lines.length && dropIndex >= 0 && dropIndex < lines.length) {
                // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
                const draggedItem = lines.splice(draggedIndex, 1)[0];
                lines.splice(dropIndex, 0, draggedItem);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º textarea
                textarea.value = lines.join('\n');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                updateImagePreview(lines);
            }
            
            draggedIndex = null;
        }
        
        function updateImagePreview(imageUrls) {
            const previewContainer = document.getElementById('image-preview-container');
            if (!previewContainer) return;
            
            const validUrls = imageUrls.filter(url => url.trim().startsWith('http'));
            
            if (validUrls.length > 0) {
                previewContainer.innerHTML = validUrls.map((url, index) => `
                    <div class="draggable-image" draggable="true" data-index="${index}" style="position: relative; cursor: move; transition: transform 0.2s; background: #f8f9fa; border-radius: 8px; padding: 8px; border: 1px solid #ddd;" 
                         ondragstart="handleDragStart(event, ${index})" 
                         ondragover="handleDragOver(event)" 
                         ondragleave="handleDragLeave(event)"
                         ondrop="handleDrop(event, ${index})" 
                         ondragend="handleDragEnd(event)"
                         onmouseenter="this.style.transform='scale(1.02)'"
                         onmouseleave="this.style.transform='scale(1)'">
                        <img src="${url}" alt="Image ${index + 1}" style="width: 100%; height: auto; max-height: 300px; object-fit: contain; border-radius: 4px; display: block;" onerror="this.src='/static/images/placeholder.jpg'">
                        <div style="position: absolute; top: 12px; left: 12px; background: rgba(0,0,0,0.7); color: white; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;">${index + 1}</div>
                        <button type="button" onclick="removeImageFromList(${index})" class="btn btn-danger" style="position: absolute; top: 12px; right: 12px; padding: 6px; width: 28px; height: 28px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; z-index: 10; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                <line x1="18" y1="6" x2="6" y2="18"></line>
                                <line x1="6" y1="6" x2="18" y2="18"></line>
                            </svg>
                        </button>
                    </div>
                `).join('');
            } else {
                previewContainer.parentElement.innerHTML = '<p style="color: #999; font-style: italic;">–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</p>';
            }
        }
        
        function removeImageFromList(index) {
            const textarea = document.getElementById('edit-image-urls');
            if (!textarea) return;
            
            const lines = textarea.value.split('\n').filter(line => line.trim());
            if (index >= 0 && index < lines.length) {
                lines.splice(index, 1);
                textarea.value = lines.join('\n');
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
                updateImagePreview(lines);
            }
        }
    </script>
    <!-- Admin panel updated: 2024-01-20 15:30:00 -->
</body>
</html>
